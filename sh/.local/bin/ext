#!/bin/bash
# Description: Extract files
# Shell: Bash
set -eu -o pipefail

[ "$#" = 0 ] && (echo "ext: missing filename" && exit)
[ ! -f "$1" ] && (echo "ext: invalid file" && exit)

file=$1
out_dir="$(basename "${file%.*}")"
mime_type="$(file -bL --mime-type "$file")"

case "$mime_type" in
	*/x-bzip2|*/gzip|*/xz) tar -xvaf "$file" --one-top-level;;
	*/zip) 7z x "$file" -o"$out_dir";;
	*/x-rar) unrar x "$file";;
	*) echo "Unsupported or invalid file type"
esac
