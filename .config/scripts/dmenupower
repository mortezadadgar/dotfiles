#!/bin/sh
# Description: A simple powermenu with dmenu
# Dependencies: dmenu
# Shell: POSIX compliant

select=$(printf "Poweroff\nRestart\nLogoff\nLockscreen\nSwitch sleep mode" |
	dmenu -h 29 -sb '#FABD2F' -nf '#fff' -sf '#000')

LOGOFF_CMD="bspc quit"

case $select in
	Poweroff)
		notify-send -i system-shutdown "Shutting down..."
		sleep 0.75
		clear > /dev/tty1
		poweroff
		;;
	Restart)
		notify-send -i system-reboot "Restarting..."
		sleep 0.75
		clear > /dev/tty1
		reboot
		;;
	Logoff)
		notify-send -i cs-user "Logging off..." -u low
		sleep 0.75
		$LOGOFF_CMD
		;;
	Lockscreen)
		notify-send -i gnome-lockscreen "Lockscreen..." -u low
		sleep 0.75
		xset s activate
		xset dpms force off
		;;
	Switch*)
		notify-send -i sleep "Switching sleep mode..." -u low
		if [ "$(xset q |awk '/timeout/ {print $2}')" -ne 0 ]; then
			xset s off
			polybar-msg -p $(pidof polybar) hook sleep 2
		else
			$(grep "xset s" "$HOME/.config/bspwm/bspwmrc")
			polybar-msg -p $(pidof polybar) hook sleep 1
		fi
esac
